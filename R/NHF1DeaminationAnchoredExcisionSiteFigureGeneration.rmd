---
title: "NHF1 Deamination Anchored Excision Site Figure Generation"
author: "Ben Morledge-Hampton"
date: "5/2/2022"
output: html_document
params:
  bioinformaticsDirectory:
    label: "Bioinformatics Projects Directory"
    value: C:/Bioinformatics_Projects
    input: select
    choices: [C:/Bioinformatics_Projects, F:/Bioinformatics_Projects]
---


```{r setup_chunk}
library(knitr)

expansionOffset = 10
cellType = "NHF1"
CPDTimepoints = list(`1h` = NULL, `8h` = NULL, `24h` = NULL, `48h` = NULL)
sixFourTimepoints = list(`5min` = NULL, `20min` = NULL, `1h` = NULL)

opts_chunk$set(dev = "png", dpi = 600, fig.width = 7, fig.height = 5, 
               fig.path = paste0(file.path("deamination_analysis_output", cellType,
                                           "deamination_anchored_excision_site_figures"),
                                 .Platform$file.sep))
if (interactive()) {
  bioinformaticsDirectory = choose.dir(caption = "Select Bioinformatics_Projects Directory")
} else {
  bioinformaticsDirectory = params$bioinformaticsDirectory
}

deaminationDataDirectory = file.path(bioinformaticsDirectory, "deamination_determination", "data", cellType)
deaminationExcisionSiteDataDirectory = file.path(deaminationDataDirectory, "excision_site_analysis")
```


```{r source_functions}
source(file.path(bioinformaticsDirectory, "deamination_determination", 'R',
                 "UsefulFileSystemFunctions.R"))
source(file.path(bioinformaticsDirectory, "deamination_determination", 'R',
                 "DeaminationAnchoredExcisionSiteAnalysis.R"))
```


```{r read_nucleotide_frequency_data}
threePrimeMismatchCPDNucFreq = list(rep1 = NULL, rep2 = NULL)
for (i in seq_along(threePrimeMismatchCPDNucFreq)) {
  threePrimeMismatchCPDNucFreq[[i]] = fread(generateFilePath(
    directory = deaminationExcisionSiteDataDirectory, dataTypeStrings$nucleotideFrequencyData, ".tsv",
    cellType = cellType, lesion = "CPD", repitition = names(threePrimeMismatchCPDNucFreq)[i],
    strandPolarity = "three_prime", anchored = TRUE
  ))
}

fivePrimeMismatchCPDNucFreq = list(rep1 = NULL, rep2 = NULL)
for (i in seq_along(fivePrimeMismatchCPDNucFreq)) {
  fivePrimeMismatchCPDNucFreq[[i]] = fread(generateFilePath(
    directory = deaminationExcisionSiteDataDirectory, dataTypeStrings$nucleotideFrequencyData, ".tsv",
    cellType = cellType, lesion = "CPD", repitition = names(fivePrimeMismatchCPDNucFreq)[i],
    strandPolarity = "five_prime", anchored = TRUE
  ))
}


threePrimeMismatchSixFourNucFreq = list(rep1 = NULL, rep2 = NULL)
for (i in seq_along(threePrimeMismatchSixFourNucFreq)) {
  threePrimeMismatchSixFourNucFreq[[i]] = fread(generateFilePath(
    directory = deaminationExcisionSiteDataDirectory, dataTypeStrings$nucleotideFrequencyData, ".tsv",
    cellType = cellType, lesion = "6-4", repitition = names(threePrimeMismatchSixFourNucFreq)[i],
    strandPolarity = "three_prime", anchored = TRUE
  ))
}

fivePrimeMismatchSixFourNucFreq = list(rep1 = NULL, rep2 = NULL)
for (i in seq_along(fivePrimeMismatchSixFourNucFreq)) {
  fivePrimeMismatchSixFourNucFreq[[i]] = fread(generateFilePath(
    directory = deaminationExcisionSiteDataDirectory, dataTypeStrings$nucleotideFrequencyData, ".tsv",
    cellType = cellType, lesion = "6-4", repitition = names(fivePrimeMismatchSixFourNucFreq)[i],
    strandPolarity = "five_prime", anchored = TRUE
  ))
}
```


```{r CPD_mismatch_anchored_nucleotide_frequencies, fig.width = 11, fig.height = 7}
plotNucFreqVsReadLengthBarPlot(threePrimeMismatchCPDNucFreq$rep1, 
                               title = "CPD 3' Anchored Nucleotide Frequencies Rep1",
                               secondaryYAxisLabel = "5' Cut Site Distance",
                               posType = THREE_PRIME, showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset)
plotNucFreqVsReadLengthBarPlot(threePrimeMismatchCPDNucFreq$rep2, 
                               title = "CPD 3' Anchored Nucleotide Frequencies Rep2",
                               secondaryYAxisLabel = "5' Cut Site Distance",
                               posType = THREE_PRIME, showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset)

plotNucFreqVsReadLengthBarPlot(fivePrimeMismatchCPDNucFreq$rep1, 
                               title = "CPD 5' Anchored Nucleotide Frequencies Rep1",
                               yAxisLabel = "Purine Frequency", secondaryYAxisLabel = "3' Cut Site Distance",
                               posType = FIVE_PRIME, showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset)
plotNucFreqVsReadLengthBarPlot(fivePrimeMismatchCPDNucFreq$rep2, 
                               title = "CPD 5' Anchored Nucleotide Frequencies Rep2",
                               yAxisLabel = "Purine Frequency", secondaryYAxisLabel = "3' Cut Site Distance",
                               posType = FIVE_PRIME, showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset)
```


```{r CPD_mismatch_anchored_purine_frequencies, fig.width = 11, fig.height = 7}
plotNucFreqVsReadLengthBarPlot(threePrimeMismatchCPDNucFreq$rep1, 
                               title = "CPD 3' Anchored Purine Frequencies Rep1",
                               yAxisLabel = "Purine Frequency", secondaryYAxisLabel = "5' Cut Site Distance",
                               combineNucleotides = c("AG"), combinedNames = c("Purine"),
                               posType = THREE_PRIME, showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset)
plotNucFreqVsReadLengthBarPlot(threePrimeMismatchCPDNucFreq$rep2, 
                               title = "CPD 3' Anchored Purine Frequencies Rep2",
                               yAxisLabel = "Purine Frequency", secondaryYAxisLabel = "5' Cut Site Distance",
                               combineNucleotides = c("AG"), combinedNames = c("Purine"),
                               posType = THREE_PRIME, showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset)

plotNucFreqVsReadLengthBarPlot(fivePrimeMismatchCPDNucFreq$rep1, 
                               title = "CPD 5' Anchored Purine Frequencies Rep1",
                               yAxisLabel = "Purine Frequency", secondaryYAxisLabel = "3' Cut Site Distance",
                               combineNucleotides = c("AG"), combinedNames = c("Purine"),
                               posType = FIVE_PRIME, showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset)
plotNucFreqVsReadLengthBarPlot(fivePrimeMismatchCPDNucFreq$rep2, 
                               title = "CPD 5' Anchored Purine Frequencies Rep2",
                               yAxisLabel = "Purine Frequency", secondaryYAxisLabel = "3' Cut Site Distance",
                               combineNucleotides = c("AG"), combinedNames = c("Purine"),
                               posType = FIVE_PRIME, showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset)
```


```{r 6-4_mismatch_anchored_nucleotide_frequencies, fig.width = 11, fig.height = 7}
plotNucFreqVsReadLengthBarPlot(threePrimeMismatchSixFourNucFreq$rep1, 
                               title = "6-4 3' Anchored Nucleotide Frequencies Rep1",
                               secondaryYAxisLabel = "5' Cut Site Distance",
                               posType = THREE_PRIME, showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset)
plotNucFreqVsReadLengthBarPlot(threePrimeMismatchSixFourNucFreq$rep2, 
                               title = "6-4 3' Anchored Nucleotide Frequencies Rep2",
                               secondaryYAxisLabel = "5' Cut Site Distance",
                               posType = THREE_PRIME, showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset)

plotNucFreqVsReadLengthBarPlot(fivePrimeMismatchSixFourNucFreq$rep1, 
                               title = "6-4 5' Anchored Nucleotide Frequencies Rep1",
                               yAxisLabel = "Purine Frequency", secondaryYAxisLabel = "3' Cut Site Distance",
                               posType = FIVE_PRIME, showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset)
plotNucFreqVsReadLengthBarPlot(fivePrimeMismatchSixFourNucFreq$rep2, 
                               title = "6-4 5' Anchored Nucleotide Frequencies Rep2",
                               yAxisLabel = "Purine Frequency", secondaryYAxisLabel = "3' Cut Site Distance",
                               posType = FIVE_PRIME, showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset)
```


```{r 6-4_mismatch_anchored_purine_frequencies, fig.width = 11, fig.height = 7}
plotNucFreqVsReadLengthBarPlot(threePrimeMismatchSixFourNucFreq$rep1, 
                               title = "6-4 3' Anchored Purine Frequencies Rep1",
                               yAxisLabel = "Purine Frequency", secondaryYAxisLabel = "5' Cut Site Distance",
                               combineNucleotides = c("AG"), combinedNames = c("Purine"),
                               posType = THREE_PRIME, showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset)
plotNucFreqVsReadLengthBarPlot(threePrimeMismatchSixFourNucFreq$rep2, 
                               title = "6-4 3' Anchored Purine Frequencies Rep2",
                               yAxisLabel = "Purine Frequency", secondaryYAxisLabel = "5' Cut Site Distance",
                               combineNucleotides = c("AG"), combinedNames = c("Purine"),
                               posType = THREE_PRIME, showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset)

plotNucFreqVsReadLengthBarPlot(fivePrimeMismatchSixFourNucFreq$rep1, 
                               title = "6-4 5' Anchored Purine Frequencies Rep1",
                               yAxisLabel = "Purine Frequency", secondaryYAxisLabel = "3' Cut Site Distance",
                               combineNucleotides = c("AG"), combinedNames = c("Purine"),
                               posType = FIVE_PRIME, showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset)
plotNucFreqVsReadLengthBarPlot(fivePrimeMismatchSixFourNucFreq$rep2, 
                               title = "6-4 5' Anchored Purine Frequencies Rep2",
                               yAxisLabel = "Purine Frequency", secondaryYAxisLabel = "3' Cut Site Distance",
                               combineNucleotides = c("AG"), combinedNames = c("Purine"),
                               posType = FIVE_PRIME, showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset)
```


```{r read_sequence_enrichment_data}
threePrimeMMAnchoredCPDEnrichment = list(rep1 = CPDTimepoints,
                                         rep2 = CPDTimepoints)
for (i in seq_along(threePrimeMMAnchoredCPDEnrichment)) {
  for (j in seq_along(threePrimeMMAnchoredCPDEnrichment[[i]])) {
    threePrimeMMAnchoredCPDEnrichment[[i]][[j]] = fread(generateFilePath(
      directory = deaminationExcisionSiteDataDirectory, dataTypeStrings$sequenceEnrichment, ".tsv",
      cellType = cellType, lesion = "CPD", repitition = names(threePrimeMMAnchoredCPDEnrichment)[i],
      timepoint = names(threePrimeMMAnchoredCPDEnrichment[[i]])[j], strandPolarity = "three_prime",
      anchored = TRUE, sequence = "YR"
    ))
  }
}

fivePrimeMMAnchoredCPDEnrichment = list(rep1 = CPDTimepoints,
                                        rep2 = CPDTimepoints)
for (i in seq_along(fivePrimeMMAnchoredCPDEnrichment)) {
  for (j in seq_along(fivePrimeMMAnchoredCPDEnrichment[[i]])) {
    fivePrimeMMAnchoredCPDEnrichment[[i]][[j]] = fread(generateFilePath(
      directory = deaminationExcisionSiteDataDirectory, dataTypeStrings$sequenceEnrichment, ".tsv",
      cellType = cellType, lesion = "CPD", repitition = names(fivePrimeMMAnchoredCPDEnrichment)[i],
      timepoint = names(fivePrimeMMAnchoredCPDEnrichment[[i]])[j], strandPolarity = "five_prime",
      anchored = TRUE, sequence = "TGG"
    ))
  }
}


threePrimeMMAnchoredSixFourEnrichment = list(rep1 = sixFourTimepoints,
                                             rep2 = sixFourTimepoints)
for (i in seq_along(threePrimeMMAnchoredSixFourEnrichment)) {
  for (j in seq_along(threePrimeMMAnchoredSixFourEnrichment[[i]])) {
    threePrimeMMAnchoredSixFourEnrichment[[i]][[j]] = fread(generateFilePath(
      directory = deaminationExcisionSiteDataDirectory, dataTypeStrings$sequenceEnrichment, ".tsv",
      cellType = cellType, lesion = "6-4", repitition = names(threePrimeMMAnchoredSixFourEnrichment)[i],
      timepoint = names(threePrimeMMAnchoredSixFourEnrichment[[i]])[j], strandPolarity = "three_prime",
      anchored = TRUE, sequence = "YR"
    ))
  }
}

fivePrimeMMAnchoredSixFourEnrichment = list(rep1 = sixFourTimepoints,
                                            rep2 = sixFourTimepoints)
for (i in seq_along(fivePrimeMMAnchoredSixFourEnrichment)) {
  for (j in seq_along(fivePrimeMMAnchoredSixFourEnrichment[[i]])) {
    fivePrimeMMAnchoredSixFourEnrichment[[i]][[j]] = fread(generateFilePath(
      directory = deaminationExcisionSiteDataDirectory, dataTypeStrings$sequenceEnrichment, ".tsv",
      cellType = cellType, lesion = "6-4", repitition = names(fivePrimeMMAnchoredSixFourEnrichment)[i],
      timepoint = names(fivePrimeMMAnchoredSixFourEnrichment[[i]])[j], strandPolarity = "five_prime",
      anchored = TRUE, sequence = "TGG"
    ))
  }
}
```


```{r CPD_sequence_enrichment, fig.width = 11, fig.height = 7}
plotSequenceEnrichment(threePrimeMMAnchoredCPDEnrichment$rep1,
                       title = "CPD 3' Anchored YR Enrichment Rep1", secondaryYAxisLabel = "5' Cut Site Distance",
                       showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset,
                       querySequences = c("CG","CA","TG","TA"))
plotSequenceEnrichment(threePrimeMMAnchoredCPDEnrichment$rep2,
                       title = "CPD 3' Anchored YR Enrichment Rep2", secondaryYAxisLabel = "5' Cut Site Distance",
                       showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset,
                       querySequences = c("CG","CA","TG","TA"))

plotSequenceEnrichment(fivePrimeMMAnchoredCPDEnrichment$rep1,
                       title = "CPD 5' Anchored TGG Enrichment Rep1", secondaryYAxisLabel = "3' Cut Site Distance",
                       showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset, posType = FIVE_PRIME,
                       querySequences = c("TGG"))
plotSequenceEnrichment(fivePrimeMMAnchoredCPDEnrichment$rep2,
                       title = "CPD 5' Anchored TGG Enrichment Rep2", secondaryYAxisLabel = "3' Cut Site Distance",
                       showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset, posType = FIVE_PRIME,
                       querySequences = c("TGG"))
```


```{r 6-4_sequence_enrichment, fig.width = 11, fig.height = 7}
plotSequenceEnrichment(threePrimeMMAnchoredSixFourEnrichment$rep1,
                       title = "6-4 3' Anchored YR Enrichment Rep1", secondaryYAxisLabel = "5' Cut Site Distance",
                       showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset,
                       querySequences = c("CG","CA","TG","TA"))
plotSequenceEnrichment(threePrimeMMAnchoredSixFourEnrichment$rep2,
                       title = "6-4 3' Anchored YR Enrichment Rep2", secondaryYAxisLabel = "5' Cut Site Distance",
                       showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset,
                       querySequences = c("CG","CA","TG","TA"))

plotSequenceEnrichment(fivePrimeMMAnchoredSixFourEnrichment$rep1,
                       title = "6-4 5' Anchored TGG Enrichment Rep1", secondaryYAxisLabel = "3' Cut Site Distance",
                       showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset, posType = FIVE_PRIME,
                       querySequences = c("TGG"))
plotSequenceEnrichment(fivePrimeMMAnchoredSixFourEnrichment$rep2,
                       title = "6-4 5' Anchored TGG Enrichment Rep2", secondaryYAxisLabel = "3' Cut Site Distance",
                       showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset, posType = FIVE_PRIME,
                       querySequences = c("TGG"))
```


```{r enrichment_test_1}
for (i in 1:5) {
  testTable = data.table(Read_Length = 9,
                         Read_Sequence = replicate(1000, paste0(sample(c('A','C','G','T'), 9, TRUE), collapse = '')))
  testTableNucFreq = tabulateNucFreqByPosTimepointAndLength(testTable)
  testEnrichment = getSequenceFreqByReadLengthAndPos(testTable, testTableNucFreq, c("CG","CA","TG","TA"))
  plotSequenceEnrichment(testEnrichment, title = "CPD 3' Anchored YR Enrichment Rep1")
}
```


```{r enrichment_test_2}
for (i in 1:5) {
  testTable = data.table(Read_Length = 9,
                         Read_Sequence = replicate(1000,
                                                   paste0(sample(c(rep('A',6),rep('C',4),rep('G',4),rep('T',6)),
                                                                 9, TRUE), collapse = '')))
  testTableNucFreq = tabulateNucFreqByPosTimepointAndLength(testTable)
  testEnrichment = getSequenceFreqByReadLengthAndPos(testTable, testTableNucFreq, c("CG","CA","TG","TA"))
  plotSequenceEnrichment(testEnrichment, title = "CPD 3' Anchored YR Enrichment Rep1")
}
```


```{r read_sequence_frequency_data}
threePrimeMMAnchoredCPDSeqFreq = list(rep1 = CPDTimepoints,
                                      rep2 = CPDTimepoints)
for (i in seq_along(threePrimeMMAnchoredCPDSeqFreq)) {
  for (j in seq_along(threePrimeMMAnchoredCPDSeqFreq[[i]])) {
    threePrimeMMAnchoredCPDSeqFreq[[i]][[j]] = fread(generateFilePath(
      directory = deaminationExcisionSiteDataDirectory, dataTypeStrings$sequenceFrequency, ".tsv",
      cellType = cellType, lesion = "CPD", repitition = names(threePrimeMMAnchoredCPDSeqFreq)[i],
      timepoint = names(threePrimeMMAnchoredCPDSeqFreq[[i]])[j], strandPolarity = "three_prime",
      anchored = TRUE, sequence = "YR"
    ))
  }
}

fivePrimeMMAnchoredCPDSeqFreq = list(rep1 = CPDTimepoints,
                                     rep2 = CPDTimepoints)
for (i in seq_along(fivePrimeMMAnchoredCPDSeqFreq)) {
  for (j in seq_along(fivePrimeMMAnchoredCPDSeqFreq[[i]])) {
    fivePrimeMMAnchoredCPDSeqFreq[[i]][[j]] = fread(generateFilePath(
      directory = deaminationExcisionSiteDataDirectory, dataTypeStrings$sequenceFrequency, ".tsv",
      cellType = cellType, lesion = "CPD", repitition = names(fivePrimeMMAnchoredCPDSeqFreq)[i],
      timepoint = names(fivePrimeMMAnchoredCPDSeqFreq[[i]])[j], strandPolarity = "five_prime",
      anchored = TRUE, sequence = "TGG"
    ))
  }
}


threePrimeMMAnchoredSixFourSeqFreq = list(rep1 = sixFourTimepoints,
                                          rep2 = sixFourTimepoints)
for (i in seq_along(threePrimeMMAnchoredSixFourSeqFreq)) {
  for (j in seq_along(threePrimeMMAnchoredSixFourSeqFreq[[i]])) {
    threePrimeMMAnchoredSixFourSeqFreq[[i]][[j]] = fread(generateFilePath(
      directory = deaminationExcisionSiteDataDirectory, dataTypeStrings$sequenceFrequency, ".tsv",
      cellType = cellType, lesion = "6-4", repitition = names(threePrimeMMAnchoredSixFourSeqFreq)[i],
      timepoint = names(threePrimeMMAnchoredSixFourSeqFreq[[i]])[j], strandPolarity = "three_prime",
      anchored = TRUE, sequence = "YR"
    ))
  }
}

fivePrimeMMAnchoredSixFourSeqFreq = list(rep1 = sixFourTimepoints,
                                         rep2 = sixFourTimepoints)
for (i in seq_along(fivePrimeMMAnchoredSixFourSeqFreq)) {
  for (j in seq_along(fivePrimeMMAnchoredSixFourSeqFreq[[i]])) {
    fivePrimeMMAnchoredSixFourSeqFreq[[i]][[j]] = fread(generateFilePath(
      directory = deaminationExcisionSiteDataDirectory, dataTypeStrings$sequenceFrequency, ".tsv",
      cellType = cellType, lesion = "6-4", repitition = names(fivePrimeMMAnchoredSixFourSeqFreq)[i],
      timepoint = names(fivePrimeMMAnchoredSixFourSeqFreq[[i]])[j], strandPolarity = "five_prime",
      anchored = TRUE, sequence = "TGG"
    ))
  }
}
```


```{r CPD_sequence_frequencies, fig.width = 11, fig.height = 7}
plotSequenceFrequencies(threePrimeMMAnchoredCPDSeqFreq$rep1,
                        title = "CPD 3' Anchored YR Frequency Rep1", secondaryYAxisLabel = "5' Cut Site Distance",
                        showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset,
                        querySequences = c("CG","CA","TG","TA"))
plotSequenceFrequencies(threePrimeMMAnchoredCPDSeqFreq$rep2,
                        title = "CPD 3' Anchored YR Frequency Rep2", secondaryYAxisLabel = "5' Cut Site Distance",
                        showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset,
                        querySequences = c("CG","CA","TG","TA"))

plotSequenceFrequencies(fivePrimeMMAnchoredCPDSeqFreq$rep1,
                        title = "CPD 5' Anchored TGG Frequency Rep1", secondaryYAxisLabel = "3' Cut Site Distance",
                        showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset, posType = FIVE_PRIME,
                        querySequences = c("TGG"))
plotSequenceFrequencies(fivePrimeMMAnchoredCPDSeqFreq$rep2,
                        title = "CPD 5' Anchored TGG Frequency Rep2", secondaryYAxisLabel = "3' Cut Site Distance",
                        showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset, posType = FIVE_PRIME,
                        querySequences = c("TGG"))
```


```{r 6-4_sequence_frequencies, fig.width = 11, fig.height = 7}
plotSequenceFrequencies(threePrimeMMAnchoredSixFourSeqFreq$rep1,
                        title = "6-4 3' Anchored YR Frequency Rep1", secondaryYAxisLabel = "5' Cut Site Distance",
                        showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset,
                        querySequences = c("CG","CA","TG","TA"))
plotSequenceFrequencies(threePrimeMMAnchoredSixFourSeqFreq$rep2,
                        title = "6-4 3' Anchored YR Frequency Rep2", secondaryYAxisLabel = "5' Cut Site Distance",
                        showFivePrimeCutSite = TRUE, expansionOffset = expansionOffset,
                        querySequences = c("CG","CA","TG","TA"))

plotSequenceFrequencies(fivePrimeMMAnchoredSixFourSeqFreq$rep1,
                        title = "6-4 5' Anchored TGG Frequency Rep1", secondaryYAxisLabel = "3' Cut Site Distance",
                        showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset, posType = FIVE_PRIME,
                        querySequences = c("TGG"))
plotSequenceFrequencies(fivePrimeMMAnchoredSixFourSeqFreq$rep2,
                        title = "6-4 5' Anchored TGG Frequency Rep2", secondaryYAxisLabel = "3' Cut Site Distance",
                        showThreePrimeCutSite = TRUE, expansionOffset = expansionOffset, posType = FIVE_PRIME,
                        querySequences = c("TGG"))
```


